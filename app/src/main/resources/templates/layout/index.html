<!DOCTYPE html>
<html lang="zh-cmn-Hans" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.eryansky.com/thymeleaf/shiro">
  <head>
    <title>[[${T(com.eryansky.utils.AppConstants).getAppFullName()}]]</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=EDGE;chrome=1" />
    <meta name="renderer" content="webkit">
    <link rel="shortcut icon" href="/static/img/favicon.ico" th:href="@{/static/img/favicon.ico}"/>
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css" th:href="@{/static/js/adminlte/bootstrap/css/bootstrap.min.css}">
    <link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css" th:href="@{/static/js/adminlte/dist/css/font-awesome.min.css}">
    <link rel="stylesheet" href="bower_components/Ionicons/css/ionicons.min.css" th:href="@{/static/js/adminlte/dist/css/ionicons.min.css}">
    <link rel="stylesheet" href="dist/css/AdminLTE.min.css" th:href="@{/static/js/adminlte/dist/css/AdminLTE.min.css}">
    <link rel="stylesheet" href="dist/css/skins/_all-skins.min.css" th:href="@{/static/js/adminlte/dist/css/skins/all-skins.min.css}">
    <link href="/static/js/jquery-jbox/2.3/Skins/Bootstrap/jbox.css" th:href="@{/static/js/jquery-jbox/2.3/Skins/Bootstrap/jbox.css}" rel="stylesheet" />
    <style type="text/css">
      html {overflow: hidden;}
    </style>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="../plugins/ie9/html5shiv.min.js" th:src="@{/static/js/adminlte/plugins/ie9/html5shiv.min.js}"></script>
    <script src="../plugins/ie9/respond.min.js" th:src="@{/static/js/adminlte/plugins/ie9/respond.min.js}"></script>
    <![endif]-->
    <script type="text/javascript">
      var ctx = window.document.location.pathname.substring(0, window.document.location.pathname.indexOf('\/', 1));
      var ctxAdmin = ctx+'/a';
      var ctxStatic = ctx+'/static';
    </script>
  </head>
  <body class="hold-transition skin-blue sidebar-mini fixed">
    <div class="wrapper">

      <header class="main-header">
        <!-- Logo -->
        <a href="#" class="logo">
          <!-- mini logo for sidebar mini 50x50 pixels -->
          <span class="logo-mini">[[${T(com.eryansky.utils.AppConstants).getAppName()}]]</span>
          <!-- logo for regular state and mobile devices -->
          <span class="logo-lg">[[${T(com.eryansky.utils.AppConstants).getAppFullName()}]]</span>
        </a>
        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top">
          <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
            <span class="sr-only">切换导航</span>
          </a>
          <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
            <ul class="nav navbar-nav">
            </ul>
          </div>
          <div class="navbar-custom-menu">
            <ul class="nav navbar-nav">
              <li class="dropdown user user-menu">
                <!-- Menu Toggle Button -->
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="fa fa-gears"></i>
                </a>
                <ul class="dropdown-menu">
                  <!-- The user image in the menu -->
                  <li class="user-header">
                    <img src="../../dist/img/user2-160x160.jpg" th:src="${userPhoto}" class="img-circle" alt="User Image">
                    <p>
                      [[${sessionInfo.name}]]
                      <small>[[${sessionInfo.loginOrganName}]]</small>
                    </p>
                  </li>
                  <!-- Menu Footer-->
                  <li class="user-footer">
                    <!--                    <div class="pull-left">-->
                    <!--                      <a href="#" class="btn btn-default btn-flat">密码修改</a>-->
                    <!--                    </div>-->
                    <div class="pull-right">
                      <a href="javascript:void(0);" class="btn btn-default btn-flat" onclick="logout()">退出</a>
                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </nav>
      </header>
      <!-- Left side column. contains the logo and sidebar -->
      <aside class="main-sidebar">
        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">
          <!-- Sidebar user panel -->
          <div class="user-panel">
            <div class="pull-left image">
              <img src="../dist/img/user2-160x160.jpg" th:src="${userPhoto}" class="img-circle" alt="User Image">
            </div>
            <div class="pull-left info">
              <p>[[${sessionInfo.name}]]</p>
              <a href="#"><i class="fa fa-circle text-success"></i> 在线</a>
            </div>
          </div>

          <!-- search form -->
          <form action="#" method="get" class="sidebar-form">
            <div class="input-group">
              <input type="text" name="q" class="form-control" placeholder="搜索...">
              <span class="input-group-btn">
                <button type="button" name="search" id="search-btn" class="btn btn-flat" onclick="search_menu()"><i
                        class="fa fa-search"></i>
                </button>
              </span>
            </div>
          </form>
          <!-- /.search form -->
          <!-- sidebar menu: : style can be found in sidebar.less -->
          <ul class="sidebar-menu">
          </ul>
        </section>
        <!-- /.sidebar -->
      </aside>

      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper" id="content-wrapper" style="min-height: 421px;">
        <!--bootstrap tab风格 多标签页-->
        <div class="content-tabs">
          <button class="roll-nav roll-left tabLeft" onclick="scrollTabLeft()">
            <i class="fa fa-backward"></i>
          </button>
          <nav class="page-tabs menuTabs tab-ui-menu" id="tab-menu">
            <div class="page-tabs-content" style="margin-left: 0px;">

            </div>
          </nav>
          <button class="roll-nav roll-right tabRight" onclick="scrollTabRight()">
            <i class="fa fa-forward" style="margin-left: 3px;"></i>
          </button>
          <div class="btn-group roll-nav roll-right">
            <button class="dropdown tabClose" data-toggle="dropdown">
              页签操作<i class="fa fa-caret-down" style="padding-left: 3px;"></i>
            </button>
            <ul class="dropdown-menu dropdown-menu-right" style="min-width: 128px;">
              <li><a class="tabReload" href="javascript:refreshTab();">刷新当前</a></li>
              <li><a class="tabCloseCurrent" href="javascript:closeCurrentTab();">关闭当前</a></li>
              <li><a class="tabCloseAll" href="javascript:closeOtherTabs(true);">全部关闭</a></li>
              <li><a class="tabCloseOther" href="javascript:closeOtherTabs();">除此之外全部关闭</a></li>
            </ul>
          </div>
          <button class="roll-nav roll-right fullscreen" onclick="App.handleFullScreen()"><i
                  class="fa fa-arrows-alt"></i></button>
        </div>
        <div class="content-iframe " style="background-color: #ffffff; ">
          <div class="tab-content " id="tab-content">

          </div>
        </div>
      </div>
      <!-- /.content-wrapper -->

      <footer class="main-footer">
        <div class="pull-right hidden-xs">
          <b>V</b> [[${T(com.eryansky.utils.AppConstants).getAppVersion()}]]
        </div>
        <!-- Default to the left -->
        <strong>版权所有 &copy; 2013-[[${#dates.format(new java.util.Date().getTime(), 'yyyy')}]] <a href="#" th:href="${T(com.eryansky.utils.AppConstants).getAppProductURL()}" th:text="${T(com.eryansky.utils.AppConstants).getAppProductName()}">Company</a>[[${T(com.eryansky.utils.AppConstants).getAppProductContact()}]]</strong>
      </footer>
    </div>
    <!-- ./wrapper -->
    <!-- REQUIRED JS SCRIPTS -->
    <!--<script src="bower_components/jquery/dist/jquery.min.js" th:src="@{/static/js/adminlte/plugins/jQuery/jquery-2.2.3.min.js}"></script>-->
    <script src="/static/js/jquery/jquery-1.10.2.min.js" th:src="@{/static/js/jquery/jquery-1.10.2.min.js}" ></script>
    <script src="/static/js/jquery/jquery-migrate-1.2.1.min.js" th:src="@{/static/js/jquery/jquery-migrate-1.2.1.min.js}" ></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js" th:src="@{/static/js/adminlte/bootstrap/js/bootstrap.min.js}"></script>

    <!-- Slimscroll -->
    <script src="../plugins/slimScroll/jquery.slimscroll.min.js" th:src="@{/static/js/adminlte/plugins/slimScroll/jquery.slimscroll.min.js}"></script>
    <!-- FastClick -->
    <script src="../plugins/fastclick/fastclick.js" th:src="@{/static/js/adminlte/plugins/fastclick/fastclick.js}"></script>
    <!-- AdminLTE App -->
    <script src="../dist/js/app.js" th:src="@{/static/js/adminlte/dist/js/app.js}"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="../dist/js/demo.js" th:src="@{/static/js/adminlte/dist/js/demo.js}"></script>

    <!--tabs-->
    <script src="../dist/js/app_iframe.js" th:src="@{/static/js/adminlte/dist/js/app_iframe.js}"></script>

    <script src="/static/js/jquery-jbox/2.3/jquery.jBox-2.3.min.js" th:src="@{/static/js/jquery-jbox/2.3/jquery.jBox-2.3.min.js}" type="text/javascript"></script>
    <script src="/static/js/jquery-jbox/2.3/i18n/jquery.jBox-zh-CN.min.js" th:src="@{/static/js/jquery-jbox/2.3/i18n/jquery.jBox-zh-CN.min.js}" type="text/javascript"></script>

    <!--<script src="../dist/js/jquery.blockui.min.js"></script>
    <script src="../dist/js/appx.js"></script>
    <script src="../dist/js/bootstrap-tab.js"></script>
    <script src="../dist/js/sidebarMenu.js"></script>-->

    <script type="text/javascript">
      /**
       * 本地搜索菜单
       */
      function search_menu() {
        //要搜索的值
        var text = $('input[name=q]').val();

        var $ul = $('.sidebar-menu');
        $ul.find("a.nav-link").each(function () {
          var $a = $(this).css("border", "");

          //判断是否含有要搜索的字符串
          if ($a.children("span.menu-text").text().indexOf(text) >= 0) {

            //如果a标签的父级是隐藏的就展开
            $ul = $a.parents("ul");

            if ($ul.is(":hidden")) {
              $a.parents("ul").prev().click();
            }

            //点击该菜单
            $a.click().css("border", "1px solid");

//                return false;
          }
        });
      }

      $(function () {
        App.setbasePath(ctx);
        App.setGlobalImgPath("/static/js/adminlte/dist/img/");
        addTabs({
          id: 'portal',
          title: '首页',
          close: false,
          url: '/a/portal'
        });

        App.fixIframeCotent();



        initMenu();
        // 动态创建菜单后，可以重新计算 SlimScroll
        // $.AdminLTE.layout.fixSidebar();

        /*if ($.AdminLTE.options.sidebarSlimScroll) {
            if (typeof $.fn.slimScroll != 'undefined') {
                //Destroy if it exists
                var $sidebar = $(".sidebar");
                $sidebar.slimScroll({destroy: true}).height("auto");
                //Add slimscroll
                $sidebar.slimscroll({
                    height: ($(window).height() - $(".main-header").height()) + "px",
                    color: "rgba(0,0,0,0.2)",
                    size: "3px"
                });
            }
        }*/

      });

      var menuData = {};
      /*  初始化导航菜单 */
      function initMenu(){
        $.post(ctxAdmin+"/login/navTree2", function(data) {
          menuData = data;
          // 初始化一级导航菜单
          var ul = $("#navbar-collapse").find("ul").eq(0);
          $.each(data, function (i, firstMenu) {
            if (i == 0) {
              $(ul).append('<li class="active"><a href="javascript:void(0);" onclick="navbarActive(this)"><i class="'+firstMenu.icon+'"></i> '+firstMenu.text+'<span class="sr-only"></span></a></li>');
            } else {
              $(ul).append('<li><a href="javascript:void(0);" onclick="navbarActive(this)"><i class="'+firstMenu.icon+'"></i> '+firstMenu.text+'</a></li>');
            }
          });
          var defaultFirst = data[0];
          // 初始化二级菜单
          $('.sidebar-menu').sidebarMenu({data: defaultFirst.children});
          // 初始化首页
          initPortal(defaultFirst);
        },"json");
      }

      /**
       * 加载看板
       */
      function initPortal(menu) {
        if (menu.url) {
          addTabs({
            id: menu.id,
            title: menu.text,
            close: true,
            url: menu.url
          });
        }
      }

      /**
       * 注销
       */
      function logout() {
        var r=confirm("您确定要退出系统吗？");
        if (r==true){
          window.location.href = ctxAdmin+"/login/logout";
        }
      }

      /**
       * 导航菜单选中
       */
      function navbarActive(a) {
        var children = $("#navbar-collapse").find("ul").eq(0).find("li");
        $.each(children, function(i, li) {
          $(li).removeClass("active");
        });
        $(a).parent().addClass("active");
        // 下面切换菜单方法
        var activeMenu = $.trim($(a).text());
        $.each(menuData,function (i, menu) {
          if (activeMenu == menu.text) {
            // 初始化二级菜单
            $('.sidebar-menu').empty();
            $('.sidebar-menu').sidebarMenu({data: menu.children});
            // 初始化看板
            initPortal(menu);
          }
        })

      }
    </script>

  </body>
</html>