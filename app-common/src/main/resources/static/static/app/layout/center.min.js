var layout_center_tabs;var layout_center_tabsMenu;$(function(){layout_center_tabs=$("#layout_center_tabs").tabs();layout_center_tabsMenu=$("#layout_center_tabsMenu").menu({onClick:function(h){var d=$(this).data("tabTitle");var g=$(h.target).attr("type");if(g==="refresh"){refresh(layout_center_tabs.tabs("getTab",d));return}if(g==="close"){cancel();return}var c=layout_center_tabs.tabs("tabs");var f=[];$.each(c,function(){var i=$(this).panel("options");if(i.closable&&i.title!=d&&g==="closeOther"){f.push(i.title)}else{if(i.closable&&g==="closeAll"){f.push(i.title)}}});for(var e=0;e<f.length;e++){layout_center_tabs.tabs("close",f[e])}}});var b;layout_center_tabs.tabs({fit:true,border:false,tabHeight:36,tools:"#layout_center_tabs_full-tools",onContextMenu:function(d,f,c){d.preventDefault();layout_center_tabsMenu.menu("show",{left:d.pageX,top:d.pageY}).data("tabTitle",f)},onAdd:function(e,c){var d=$(this).tabs("getTab",c).panel("options").tab;d.unbind("mouseenter").bind("mouseenter",function(f){b=$(this).tooltip({position:"top",content:e}).tooltip("show",f)})},onBeforeClose:function(d,c){if(b){b.tooltip("destroy")}}});var a="首页";layout_center_tabs.tabs("add",{title:a,iconCls:"eu-icon-application",closable:false,content:'<iframe id="iframe_index" name="iframe_index" scrolling="no" frameborder="0" src="'+ctxAdmin+'/portal" style="width:100%;height:100%;"></iframe>'});layout_center_tabs.tabs("getTab",a).panel("options").tab.unbind("mouseenter").bind("mouseenter",function(c){$(this).tooltip({position:"top",content:a}).tooltip("show",c)})});function refresh(c){var f;if(c){f=c}else{f=layout_center_tabs.tabs("getSelected")}if(f==undefined){return}var b=f.panel("options").href;if(b){var d=layout_center_tabs.tabs("getTabIndex",f);layout_center_tabs.tabs("getTab",d).panel("refresh")}else{var a=f.panel("panel");var e=a.find("iframe");layout_center_tabs.tabs("updateIframeTab",{which:f.panel("options").title,iframe:{src:e[0].src}})}}function cancel(){var a=layout_center_tabs.tabs("getTabIndex",layout_center_tabs.tabs("getSelected"));var b=layout_center_tabs.tabs("getTab",a);if(b==undefined){return}if(b.panel("options").closable){layout_center_tabs.tabs("close",a)}else{eu.showAlertMsg("["+b.panel("options").title+"]不可以被关闭.","error")}}function screenToggle(a){var d;$(".easyui-tooltip").tooltip("hide","click");var c=layout_center_tabs.tabs("getSelected");var b=undefined;if(c){b=c.panel("options").title}if(a){d="#layout_center_tabs_unfull-tools";parent.indexLayout.layout("fullCenter")}else{d="#layout_center_tabs_full-tools";parent.indexLayout.layout("unFullCenter")}layout_center_tabs.tabs({tools:d});if(b){layout_center_tabs.tabs("select",b)}}var login_about_dialog;var login_password_dialog;var login_password_form;function showAbout(){login_about_dialog=$("<div/>").dialog({title:"关于我们",iconCls:"eu-icon-jfit_logo",top:100,width:436,height:400,modal:true,href:ctxAdmin+"/common/layout/about",buttons:[{text:"关闭",iconCls:"easyui-icon-cancel",handler:function(){login_about_dialog.dialog("destroy")}}],onClose:function(){login_about_dialog.dialog("destroy")}})}function initLoginPasswordForm(){login_password_form=$("#login_password_form").form({url:ctxAdmin+"/sys/user/updateUserPassword",onSubmit:function(param){param.upateOperate="1";return $(this).form("validate")},success:function(data){var json=eval("("+data+")");if(json.code==1){login_about_dialog.dialog("close");eu.showMsg(json.msg)}else{if(json.code==2){$.messager.alert("提示信息！",json.msg,"warning",function(){var userId=$("#login_password_form_id").val();$(this).form("clear");$("#login_password_form_id").val(userId);if(json.obj){$('#login_password_form input[name="'+json.obj+'"]').focus()}})}else{eu.showAlertMsg(json.msg,"error")}}}})}function editLoginUserPassword(){login_about_dialog=$("<div/>").dialog({title:"&nbsp;修改用户密码",top:100,width:460,height:240,modal:true,iconCls:"easyui-icon-edit",href:ctxAdmin+"/common/layout/north-password",buttons:[{text:"保存",iconCls:"easyui-icon-save",handler:function(){login_password_form.submit()}},{text:"关闭",iconCls:"easyui-icon-cancel",handler:function(){login_about_dialog.dialog("destroy")}}],onClose:function(){login_about_dialog.dialog("destroy")},onLoad:function(){initLoginPasswordForm()}})}function logout(a){$.messager.confirm("确认提示！","您确定要退出系统吗？",function(b){if(b){if(a){$.cookie("autoLogin","",{expires:7})}window.location.href=ctxAdmin+"/login/logout"}})}function toApp(){var a="app";$.cookie("themeType",a,{expires:7});window.location.href=ctxAdmin+"/login/index?theme="+a}var userinfo_dialog;function editLoginUserInfo(){var a=ctxAdmin+"/sys/user/userInfoInput";userinfo_dialog=$("<div/>").dialog({title:"个人详细信息",height:360,top:100,width:500,modal:true,maximizable:true,href:a,buttons:[{text:"保存",iconCls:"easyui-icon-save",handler:function(){$("#userinfo_form").submit()}},{text:"关闭",iconCls:"easyui-icon-cancel",handler:function(){userinfo_dialog.dialog("destroy")}}],onClose:function(){$(this).dialog("destroy")},onLoad:function(){}})}function showLayoutTabmenu(a){var b=$(a).offset();$("#layout_center_tabs_menu").menu("show",{left:b.left+$(a).outerWidth()-$("#layout_center_tabs_menu").outerWidth(),top:b.top+$(a).outerHeight()})}function refreshIndex(){var a=layout_center_tabs.tabs("getTab",indexTitle);refresh(a)}function refreshPortal(){try{$("#iframe_index")[0].contentWindow.mymessages(true,false)}catch(a){}};